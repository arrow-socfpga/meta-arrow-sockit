#@TYPE: Machine
#@NAME: arrow-sockit
#@DESCRIPTION: Machine configuration for the Arrow SoCKit Board"

require conf/machine/include/socfpga.inc

PREFERRED_PROVIDER_virtual/kernel ?= "linux-altera-ltsi"
PREFERRED_VERSION_linux-altera-ltsi ?= "4.14.130%"

#PREFERRED_PROVIDER_virtual/kernel = "linux-altera"
#PREFERRED_VERSION_linux-altera = "5.1%"

PREFERRED_PROVIDER_virtual/bootloader ?= "u-boot-socfpga"
PREFERRED_VERSION_u-boot-socfpga ?= "v2017.03%"
#PREFERRED_VERSION_u-boot-socfpga ?= "v2016.11%"
#PREFERRED_VERSION_u-boot-socfpga ?= "v2013.01.01"

UBOOT_CONFIG ??= "arrow-sockit"
UBOOT_CONFIG[arrow-sockit] = "socfpga_sockit_defconfig"

SPL_BINARY = "u-boot-with-spl.sfp"

IMAGE_CLASSES += "sdcard_image-socfpga"

IMAGE_FSTYPES = "cpio ext3 tar.gz socfpga-sdimg"

IMAGE_OVERHEAD_FACTOR = "1.5"

UBOOT_EXTLINUX = "1"
UBOOT_EXTLINUX_ROOT = "root=/dev/mmcblk0p2 rw rootwait"
UBOOT_EXTLINUX_LABELS = "default"
UBOOT_EXTLINUX_CONSOLE = "ttyS0,115200"
UBOOT_EXTLINUX_MENU_DESCRIPTION_default = "Linux Default"
UBOOT_EXTLINUX_KERNEL_IMAGE_default = "../zImage"
UBOOT_EXTLINUX_FDTDIR_default = "../"
#UBOOT_EXTLINUX_KERNEL_ARGS_default = "memmap=16M$0x3F000000"

SOCFPGA_SDIMG_EXTRA_FILES = "sockit_ghrd_1080p.rbf"

INHERIT += " rootfs_ipk "
BAD_RECOMMENDATIONS = " libavahi-core avahi-utils avahi-daemon avahi-autoipd libnss-mdns "

DISTRO_FEATURES_remove = "opengl"                                               
DISTRO_FEATURES_remove = "opencl"                                               
DISTRO_FEATURES_remove = "wayland"                                              
DISTRO_FEATURES_remove = "zeroconf"

KMACHINE = "arrow-sockit"

KERNEL_DEVICETREE = "socfpga_cyclone5_sockit.dtb"
